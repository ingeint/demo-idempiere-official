pipeline {
    agent none
    environment {
        IDEMPIERE_REPOSITORY = "/idempiere"
        REGISTRY_PASS = credentials('ingeint-registry-pass')

    }
    stages {
        stage('Build Artefact') {
            agent {
                docker { 
                     image 'portus.ingeint.com/idempiere-source:8.2'
                }
            }
            steps {
                sh 'docker login $REGISTRY_REPOSITORY -u $REGISTRY_USER -p $REGISTRY_PASS'
                sh 'docker run -d --name source portus.ingeint.com/idempiere-source sleep 60'
                sh 'docker cp source:/source/idempiere/ ./test'
                sh 'cd /test'
                sh 'ls'
            }
        }
    }
}
